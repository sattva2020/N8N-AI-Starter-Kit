# Устранение ошибки с хешем пароля Traefik в Docker Compose

## Проблема

При запуске `docker compose --profile cpu up -d` после выполнения скрипта установки могут появляться следующие предупреждения:

```
WARN[0000] The "apr1" variable is not set. Defaulting to a blank string.
WARN[0000] The "UT95I0NvcgFpXzUL" variable is not set. Defaulting to a blank string.
```

Это происходит из-за того, что Docker Compose интерпретирует символы `$` в хеше пароля Traefik как переменные окружения.

## Решение

В версии скрипта от мая 2025 эта проблема решена путем экранирования символов `$` в хеше пароля. Если вы все еще видите эту ошибку, следуйте одному из следующих способов:

### Способ 1: Ручное редактирование .env файла

1. Откройте файл `.env` в текстовом редакторе
2. Найдите строку, начинающуюся с `TRAEFIK_PASSWORD_HASHED=`
3. Замените каждый символ `$` на `$$` в хеше пароля
4. Сохраните файл и запустите Docker Compose снова

Пример:
```
# Было
TRAEFIK_PASSWORD_HASHED=$apr1$7dtH1v4e$UT95I0NvcgFpXzUL.T47j.

# Должно стать
TRAEFIK_PASSWORD_HASHED=$$apr1$$7dtH1v4e$$UT95I0NvcgFpXzUL.T47j.
```

### Способ 2: Повторный запуск скрипта установки

Если вы используете обновленную версию скрипта от мая 2025 или новее, просто запустите скрипт установки заново:

```bash
./scripts/setup.sh
```

При создании нового файла `.env` скрипт автоматически экранирует символы `$` в хеше пароля.

### Способ 3: Прямое указание пароля в docker-compose.yml

Если вы все еще сталкиваетесь с проблемой, можно временно указать пароль напрямую в файле `docker-compose.yml`:

1. Откройте файл `docker-compose.yml`
2. Найдите строку с `traefik.http.middlewares.auth.basicauth.users=${TRAEFIK_USERNAME}:${TRAEFIK_PASSWORD_HASHED}`
3. Замените ее на `traefik.http.middlewares.auth.basicauth.users=admin:$$apr1$$7dtH1v4e$$UT95I0NvcgFpXzUL.T47j.` (подставьте свой хеш)
4. Сохраните файл и запустите Docker Compose снова

## Предотвращение проблемы в будущем

Начиная с мая 2025 года, скрипт установки автоматически экранирует символы `$` в хеше пароля при создании файла `.env`. Если вы используете более старую версию скрипта, рекомендуется обновить ее до последней версии.
