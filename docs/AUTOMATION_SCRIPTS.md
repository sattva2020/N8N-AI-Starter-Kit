# Автоматизационные скрипты

В рамках улучшения проекта n8n-ai-starter-kit были созданы различные скрипты для автоматизации типовых операций и решения часто возникающих проблем.

## Обзор доступных скриптов

Все скрипты находятся в каталоге `scripts/` и доступны в версиях для Linux/macOS (`.sh`) и Windows (`.ps1`):

| Скрипт | Описание |
|--------|----------|
| [fix-env-vars](#fix-env-vars) | Исправляет проблемы с переменными окружения |
| [fix-and-start](#fix-and-start) | Исправляет переменные окружения и запускает проект |
| [start-with-limited-parallelism](#start-with-limited-parallelism) | Запускает проект с ограниченным параллелизмом для предотвращения превышения лимитов API |

## Подробное описание скриптов

### fix-env-vars

Скрипт автоматически исправляет типичные проблемы с переменными окружения в файле `.env`:

- Создает резервную копию `.env` файла
- Копирует значения из переменных `SUPABASE_*` в соответствующие внутренние переменные (`VITE_SUPABASE_URL`, `VITE_SUPABASE_ANON_KEY`, `JWT_SECRET`)
- Добавляет недостающие переменные `N8N_ENCRYPTION_KEY` и `JWT_SECRET` с автоматически сгенерированными значениями
- Выводит информацию о выполненных изменениях

**Использование:**

Linux/macOS:
```bash
./scripts/fix-env-vars.sh
```

Windows:
```powershell
.\scripts\fix-env-vars.ps1
```

### fix-and-start

Комбинированный скрипт, который сначала исправляет проблемы с переменными окружения, а затем запускает проект с помощью Docker Compose:

- Запускает скрипт `fix-env-vars`
- Останавливает существующие контейнеры Docker, если они запущены
- Запускает проект с помощью `docker-compose up -d`
- Выводит информацию о статусе и дополнительные инструкции

**Использование:**

Linux/macOS:
```bash
./scripts/fix-and-start.sh
```

Windows:
```powershell
.\scripts\fix-and-start.ps1
```

### start-with-limited-parallelism

Запускает проект с ограниченным числом параллельных выполнений, что помогает избежать превышения лимитов API при работе с внешними сервисами ИИ:

- Создает файл с переопределением переменных окружения для ограничения параллельных выполнений
- Исправляет основные переменные окружения (использует `fix-env-vars`)
- Запускает проект с применением ограничений параллелизма
- По умолчанию устанавливает максимум 2 параллельных выполнения, но это значение можно изменить

**Использование:**

Linux/macOS:
```bash
# С параметрами по умолчанию (макс. 2 параллельных выполнения)
./scripts/start-with-limited-parallelism.sh

# С указанием максимального числа параллельных выполнений
./scripts/start-with-limited-parallelism.sh -p 3
```

Windows:
```powershell
# С параметрами по умолчанию (макс. 2 параллельных выполнения)
.\scripts\start-with-limited-parallelism.ps1

# С указанием максимального числа параллельных выполнений
.\scripts\start-with-limited-parallelism.ps1 -MaxParallelism 3
```

## Рекомендации по использованию

- При первом запуске проекта рекомендуется использовать `fix-and-start`, который обеспечит корректную настройку переменных окружения
- Если вы работаете с платными API или сталкиваетесь с ограничениями на количество запросов, используйте `start-with-limited-parallelism`
- Скрипты автоматически определяют используемую версию Docker Compose (автономную или как плагин Docker)
