# Тестирование скрипта установки N8N AI Starter Kit

Это руководство содержит инструкции по тестированию скрипта установки на различных операционных системах.

## Подготовка к тестированию

1. Создайте виртуальную машину или используйте облачный инстанс с одной из следующих ОС:
   - Ubuntu 22.04 или 24.04
   - Debian 11 или 12
   - CentOS 7 или 8
   - Fedora 35+
   - macOS (если доступно)

2. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/n8n-io/n8n-ai-starter-kit.git
   cd n8n-ai-starter-kit
   ```

3. Убедитесь, что скрипт установки имеет права на выполнение:
   ```bash
   chmod +x scripts/setup.sh
   ```

## Сценарии тестирования

### 1. Базовое тестирование (без Docker)

Этот тест проверяет автоматическую установку Docker и Docker Compose:

```bash
# Если Docker уже установлен, удалите его для тестирования
sudo apt-get remove docker docker-engine docker.io containerd runc docker-compose-plugin docker-compose (Ubuntu/Debian)
# или
sudo yum remove docker docker-engine docker.io containerd runc docker-compose (CentOS/RHEL)
# или
sudo dnf remove docker docker-engine docker.io containerd runc docker-compose (Fedora)

# Запустите скрипт установки
bash scripts/setup.sh
```

Ожидаемый результат:
- Скрипт должен определить ОС
- Предложить установить Docker
- Успешно установить Docker и Docker Compose
- Пройти все проверки и создать файл .env

### 2. Тестирование с установленным Docker

Если Docker уже установлен:

```bash
bash scripts/setup.sh
```

Ожидаемый результат:
- Скрипт должен обнаружить установленный Docker
- Проверить версию Docker Compose и выбрать правильную команду
- Успешно пройти все проверки и создать файл .env

### 3. Тестирование с существующим файлом .env

Сначала запустите скрипт, чтобы создать файл .env, затем запустите его снова:

```bash
bash scripts/setup.sh
# Внесите некоторые изменения в .env
echo "# Тестовый комментарий" >> .env
# Запустите скрипт снова
bash scripts/setup.sh
```

Ожидаемый результат:
- Скрипт должен обнаружить существующий файл .env
- Предложить создать резервную копию
- После подтверждения создать резервную копию в директории ./backup/

### 4. Тестирование проверки портов

Запустите веб-сервер на порту 80 перед запуском скрипта:

```bash
# На Ubuntu/Debian
sudo apt-get install -y nginx
# или запустите простой сервер на порту 80
sudo python3 -m http.server 80

# В отдельном терминале запустите скрипт
bash scripts/setup.sh
```

Ожидаемый результат:
- Скрипт должен обнаружить, что порт 80 занят
- Выдать предупреждение о возможных проблемах с SSL сертификатами
- Предложить продолжить установку или отменить её

### 5. Тестирование с различными вводами

Проверьте реакцию скрипта на некорректный ввод:

```bash
# Запустите скрипт и введите некорректное доменное имя
bash scripts/setup.sh
# Когда скрипт запросит доменное имя, введите:
# 1. domain (некорректное, без TLD)
# 2. domain.com (корректное)
```

Ожидаемый результат:
- Скрипт должен отклонить некорректное доменное имя
- Принять корректное доменное имя и продолжить установку

## Запуск после тестирования

После успешного завершения тестирования проверьте запуск сервисов:

```bash
docker compose --profile cpu up -d
```

Проверьте, работают ли сервисы:

```bash
docker compose ps
```

## Отчет о тестировании

После завершения тестирования на каждой ОС заполните отчет:

- ОС и версия: 
- Результат базового тестирования: Успешно/Неуспешно
- Результат тестирования с Docker: Успешно/Неуспешно
- Результат тестирования с .env: Успешно/Неуспешно
- Результат тестирования портов: Успешно/Неуспешно
- Результат тестирования ввода: Успешно/Неуспешно
- Обнаруженные проблемы:
- Предложения по улучшению:

## Как использовать тестовые скрипты

### Шаги для тестирования настройки и запуска

1. **Запуск модульного тестирования скрипта установки**:
   ```bash
   # Тестирование на Linux/macOS
   ./scripts/test_setup.sh
   
   # Тестирование на Windows
   .\scripts\test_setup.ps1
   ```
